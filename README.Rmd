---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# paneldesign

<!-- badges: start -->
<!-- badges: end -->

The goal of paneldesign is to provide functionalities to design and evaluate panels. 

## Installation

You can (not yet) install the released version of paneldesign from [CRAN](https://CRAN.R-project.org) with:

``` r
install.packages("paneldesign")
```

But you can install the package from GitLab by

``` r
remotes::install_git("gitlab.rlp.net:tron/paneldesign.git")
```


## Example

This is a basic example to show you how to use the package:

```{r example}
library(paneldesign)
## basic example code
```

Given a data set of mutations in patients, the goal is to select mutations that are present in a maximum number of patients. 
We use a toy data set consisting of patients `p1`, `p2`, and `p3` of which each has 3 mutations.

```{r toy data}
mut_toy
```


### Select mutations

Here, we use a greedy algorithm to select a minimal set of mutations that 
covers all patients. 

```{r}
select_greedy(mut_toy)
```

This results in two mutations `m01` and `m02`.

### Evaluate given panel of regions

Here we use the following toy genomic region set.

```{r}
gr_toy
```

First, we associate each region to patients by overlap with the mutation data

```{r}
reg_to_patient <- panel_to_patient(gr_toy, mut_toy)

reg_to_patient
```

This results in the above-shown data set. The patient `p3` is not *covered* 
because there are no mutations in `p3` that overlap with the input regions. 
This results in 'NA' values for some region or mutation-specific columns. 

Next, we evaluate each region from the panel for the patient coverage.

```{r}
eval_regions(reg_to_patient)

```

This assumes some order of the input regions by decreasing priority and in this
way outputs additionally cumulative values such as `percent_patients_cum` which 
the cumulative percent of input patients that are covered by the current or any 
previous region. This is useful to decide where to *cut* the panel.

Lastly, we can get some overall performance metrics of the entire panel:

```{r}
eval <- eval_panel(reg_to_patient)
eval
```

This data set contains a nested data set with information on how many mutations 
each patient has represented on the panel.

```{r}
eval$mut_per_patient_df[[1]]

```


